---
id: QC-020.05
title: Agent Activity Log
status: To Do
assignee: []
created_date: '2026-01-29 16:43'
labels:
  - application
  - ai-assistant
  - P1
dependencies: []
parent_task_id: QC-020
---

## Description

<!-- SECTION:DESCRIPTION:BEGIN -->
AgentActivityLogService: log all agent actions with timestamps, coder attribution, success/failure status. Query activity history.
<!-- SECTION:DESCRIPTION:END -->

## Acceptance Criteria
<!-- AC:BEGIN -->
### ActivityEntry Value Object (frozen dataclass)
- [ ] #1 `ActivityEntry`: entry_id, timestamp, tool_name, action_type, status (SUCCESS|FAILURE|PENDING), coder_id, details
- [ ] #2 Immutable log entries

### AgentActivityLogService Interface
- [ ] #3 `log_action(tool_name, action_type, status, details) -> ActivityEntry`
- [ ] #4 `get_recent_activity(limit: int = 50) -> List[ActivityEntry]`
- [ ] #5 `get_activity_for_session(session_id) -> List[ActivityEntry]`
- [ ] #6 `get_activity_by_tool(tool_name) -> List[ActivityEntry]`
- [ ] #7 `clear_old_entries(older_than: datetime) -> int`

### Query Filters
- [ ] #8 `ActivityFilter`: tool_names, statuses, date_range, coder_id
- [ ] #9 `get_filtered_activity(filter: ActivityFilter) -> List[ActivityEntry]`

### Event Publishing
- [ ] #10 `ActivityLogged` event: entry_id, tool_name, status
- [ ] #11 Subscribes to all agent action events to auto-log

### Persistence
- [ ] #12 Stored in SQLite activity_log table
- [ ] #13 Indexed by timestamp, tool_name for fast queries
<!-- AC:END -->
