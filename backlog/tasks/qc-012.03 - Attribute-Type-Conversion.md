---
id: QC-012.03
title: Attribute Type Conversion
status: To Do
assignee: []
created_date: '2026-01-29 16:41'
labels:
  - domain
  - cases
  - P2
dependencies: []
parent_task_id: QC-012
---

## Description

<!-- SECTION:DESCRIPTION:BEGIN -->
Support attribute type conversion (text to numeric, etc). Define conversion rules and validation.
<!-- SECTION:DESCRIPTION:END -->

## Acceptance Criteria
<!-- AC:BEGIN -->
### AttributeType Value Object (frozen dataclass)
- [ ] #1 `AttributeType`: attribute_type_id, name, value_type (ValueType), owner
- [ ] #2 `ValueType` enum: CHARACTER, NUMERIC, DATE

### Conversion Rules (Pure Functions)
- [ ] #3 `can_convert(from_type: ValueType, to_type: ValueType, values: List[str]) -> bool`
- [ ] #4 `convert_value(value: str, from_type: ValueType, to_type: ValueType) -> Result[str, ConversionError]`
- [ ] #5 `validate_all_values(values: List[str], target_type: ValueType) -> ValidationResult`

### Conversion Matrix
- [ ] #6 CHARACTER → NUMERIC: valid if all values are numeric strings
- [ ] #7 CHARACTER → DATE: valid if all values parse as dates
- [ ] #8 NUMERIC → CHARACTER: always valid (trivial conversion)
- [ ] #9 NUMERIC → DATE: invalid (not meaningful)
- [ ] #10 DATE → CHARACTER: always valid (format to string)
- [ ] #11 DATE → NUMERIC: invalid (not meaningful)

### ValidationResult Value Object
- [ ] #12 `ValidationResult`: is_valid (bool), invalid_values (List[Tuple[case_id, value]]), conversion_count
- [ ] #13 Shows which specific values would fail conversion

### Invariants
- [ ] #14 `is_valid_numeric(value: str) -> bool` - can parse as float
- [ ] #15 `is_valid_date(value: str, formats: List[str]) -> bool` - can parse with given formats
- [ ] #16 `is_conversion_safe(values, target_type) -> bool` - all values convertible

### Event
- [ ] #17 `AttributeTypeConverted` event: attribute_type_id, old_type, new_type, values_converted
<!-- AC:END -->
