---
id: QC-006.06
title: Signal Payloads
status: To Do
assignee: []
created_date: '2026-01-30'
labels:
  - application
  - coding
  - signal-bridge
  - P0
dependencies: [QC-004]
parent_task_id: QC-006
---

## Description

<!-- SECTION:DESCRIPTION:BEGIN -->
Define Qt-friendly payload dataclasses for the Coding context. These are the data structures emitted by SignalBridge signals to UI widgets. Payloads are UI-optimized versions of domain events.
<!-- SECTION:DESCRIPTION:END -->

## Acceptance Criteria
<!-- AC:BEGIN -->

### Code Payloads
- [ ] #1 `CodeCreatedPayload`: code_id (str), name (str), color_hex (str), category_id (str?), owner_name (str)
- [ ] #2 `CodeRenamedPayload`: code_id (str), old_name (str), new_name (str)
- [ ] #3 `CodeDeletedPayload`: code_id (str), name (str)
- [ ] #4 `CodeColorChangedPayload`: code_id (str), old_color_hex (str), new_color_hex (str)
- [ ] #5 `CodesMergedPayload`: source_code_id (str), target_code_id (str), segments_moved (int)
- [ ] #6 `CodeMovedToCategoryPayload`: code_id (str), old_category_id (str?), new_category_id (str?)

### Category Payloads
- [ ] #7 `CategoryCreatedPayload`: category_id (str), name (str), parent_id (str?)
- [ ] #8 `CategoryDeletedPayload`: category_id (str), name (str)
- [ ] #9 `CategoryRenamedPayload`: category_id (str), old_name (str), new_name (str)
- [ ] #10 `CategoryMovedPayload`: category_id (str), old_parent_id (str?), new_parent_id (str?)

### Segment Payloads
- [ ] #11 `SegmentCodedPayload`: segment_id (str), code_id (str), code_name (str), code_color_hex (str), source_id (str), position_start (int), position_end (int), selected_text (str), owner_name (str)
- [ ] #12 `SegmentUncodedPayload`: segment_id (str), code_id (str), source_id (str)
- [ ] #13 `ImageSegmentCodedPayload`: segment_id (str), code_id (str), code_name (str), source_id (str), x (int), y (int), width (int), height (int)
- [ ] #14 `AVSegmentCodedPayload`: segment_id (str), code_id (str), code_name (str), source_id (str), start_ms (int), end_ms (int), transcript (str?)
- [ ] #15 `SegmentMemoUpdatedPayload`: segment_id (str), memo (str?)
- [ ] #16 `SegmentImportanceSetPayload`: segment_id (str), importance (int)

### Batch Operation Payloads
- [ ] #17 `AutoCodeBatchCompletedPayload`: batch_id (str), code_id (str), code_name (str), segments_created (int), source_id (str)
- [ ] #18 `AutoCodeBatchUndonePayload`: batch_id (str), segments_removed (int)

### Payload Design Rules
- [ ] #19 All payloads are frozen dataclasses (immutable)
- [ ] #20 Use primitive types only (str, int, float, bool) - no domain types
- [ ] #21 IDs are strings (not typed IDs) for Qt compatibility
- [ ] #22 Colors are hex strings (not Color value objects)
- [ ] #23 Include display-ready data (e.g., code_name alongside code_id)
- [ ] #24 Include owner_name for activity display (not CoderId)

### Base Payload Class
- [ ] #25 `SignalPayload` base class with `timestamp: str` (ISO format)
- [ ] #26 All payloads inherit from `SignalPayload`

<!-- AC:END -->

## Implementation Notes

**Why separate from Domain Events?**

Domain events carry domain types (CodeId, Color, etc.) and are for the domain layer. Payloads carry primitive types and are optimized for UI rendering:

```python
# Domain Event (in domain layer)
@dataclass(frozen=True)
class CodeCreated(DomainEvent):
    code_id: CodeId          # Typed ID
    name: str
    color: Color             # Value object
    owner: CoderId           # Typed ID

# Signal Payload (in application layer)
@dataclass(frozen=True)
class CodeCreatedPayload(SignalPayload):
    code_id: str             # String for Qt
    name: str
    color_hex: str           # "#RRGGBB" for Qt
    owner_name: str          # Display name
```

## Files

- `src/application/signal_bridge/coding_payloads.py`
