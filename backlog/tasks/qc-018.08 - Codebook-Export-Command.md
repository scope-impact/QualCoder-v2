---
id: QC-018.08
title: Codebook Export Command
status: To Do
assignee: []
created_date: '2026-01-30'
labels:
  - application
  - analysis
  - export
  - P2
dependencies: [QC-017.07]
parent_task_id: QC-018
---

## Description

Application layer command for generating and exporting codebooks.

## Acceptance Criteria

### Generate Command
- [ ] #1 `generate_codebook(options?) -> Codebook`
- [ ] #2 Default options if not specified
- [ ] #3 Returns in-memory codebook for preview

### Export Command
- [ ] #4 `export_codebook(format, path, options?) -> Result[Path, ExportError]`
- [ ] #5 Supported formats: text, markdown, odt, xlsx
- [ ] #6 Auto-suggest filename: `{project_name}_codebook_{date}.{ext}`

### Options Handling
- [ ] #7 Merge user options with defaults
- [ ] #8 Validate category_filter IDs exist

### Event Publishing
- [ ] #9 `CodebookGenerated(format, path, code_count)`

## Implementation

- `src/application/analysis/codebook_controller.py`

## Agent Tools

- `generate_codebook(format, options)` - Agent can generate for review
- Useful for AI to understand existing code structure
