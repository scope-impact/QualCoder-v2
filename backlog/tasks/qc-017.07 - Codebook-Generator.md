---
id: QC-017.07
title: Codebook Generator
status: To Do
assignee: []
created_date: '2026-01-30'
labels:
  - infrastructure
  - analysis
  - export
  - P2
dependencies: [QC-016.01]
parent_task_id: QC-017
---

## Description

Generate codebooks - structured documents listing all codes with definitions, categories, and frequencies.

## Original QualCoder Reference

- Module: `codebook.py`
- Features: Hierarchical export to ODT

## Acceptance Criteria

### CodebookGenerator Service
- [ ] #1 `generate(options: CodebookOptions) -> Codebook`
- [ ] #2 Build hierarchical structure (categories → subcategories → codes)
- [ ] #3 Include code memos/definitions
- [ ] #4 Calculate code frequencies
- [ ] #5 Filter by category (optional)

### CodebookOptions
- [ ] #6 `include_memos: bool` - Include code definitions
- [ ] #7 `include_frequencies: bool` - Include usage counts
- [ ] #8 `include_examples: bool` - Include sample coded segments
- [ ] #9 `category_filter: list[int] | None` - Filter to specific categories
- [ ] #10 `max_examples: int` - Limit examples per code

### Codebook Structure
- [ ] #11 `Codebook`: categories, codes, metadata
- [ ] #12 `CodebookEntry`: code_name, color, memo, frequency, examples, children

### Export Formats
- [ ] #13 `export_to_text(codebook, path) -> Result[Path, Error]`
- [ ] #14 `export_to_markdown(codebook, path) -> Result[Path, Error]`
- [ ] #15 `export_to_odt(codebook, path) -> Result[Path, Error]`
- [ ] #16 `export_to_xlsx(codebook, path) -> Result[Path, Error]`

## Implementation

- `src/infrastructure/analysis/codebook_generator.py`
- `src/infrastructure/analysis/codebook_exporter.py`

## Output Example

```
CODEBOOK: Project Name
Generated: 2026-01-30

Category: Interview Themes
├── Work-Life Balance (freq: 45)
│   Definition: Statements about balancing professional and personal life
│   Example: "I struggle to find time for my family..."
├── Career Progression (freq: 32)
│   Definition: Discussions of career advancement
└── Subcategory: Challenges
    ├── Time Pressure (freq: 28)
    └── Resource Constraints (freq: 15)
```
