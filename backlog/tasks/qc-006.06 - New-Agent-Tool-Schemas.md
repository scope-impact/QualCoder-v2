---
id: QC-006.06
title: New Agent Tool Schemas
status: To Do
assignee: []
created_date: '2026-01-29 16:38'
labels:
  - application
  - coding
  - agent-tools
  - P1
dependencies: []
parent_task_id: QC-006
---

## Description

<!-- SECTION:DESCRIPTION:BEGIN -->
Add agent tool schemas for auto-coding and media coding operations. Register with agent server.
<!-- SECTION:DESCRIPTION:END -->

## Acceptance Criteria
<!-- AC:BEGIN -->

### Agent Tool Schemas
- [ ] #1 `auto_code_exact` tool schema:
  - Input: code_id, source_id, text, match_type (exact|startswith|contains|endswith|regex)
  - Output: batch_id, segments_created (count)
  - Trust Level: **SUGGEST** (requires user approval before execution)

- [ ] #2 `auto_code_fragments` tool schema:
  - Input: code_id, source_id, text, similarity_threshold (0.0-1.0)
  - Output: batch_id, segments_created (count)
  - Trust Level: **SUGGEST**

- [ ] #3 `mark_speakers` tool schema:
  - Input: source_id, speaker_format (auto|colon|bracket|brace)
  - Output: speakers_detected (list), codes_created (list)
  - Trust Level: **SUGGEST**

- [ ] #4 `apply_code_to_image` tool schema:
  - Input: code_id, source_id, x, y, width, height
  - Output: segment_id
  - Trust Level: **NOTIFY** (executes, user notified)

- [ ] #5 `apply_code_to_av` tool schema:
  - Input: code_id, source_id, start_ms, end_ms, transcript (optional)
  - Output: segment_id
  - Trust Level: **NOTIFY**

- [ ] #6 `set_importance` tool schema:
  - Input: segment_id, importance (0|1)
  - Output: success (bool)
  - Trust Level: **NOTIFY**

### Schema Structure
- [ ] #7 Each schema defines: name, description, inputSchema (JSON Schema), trust_level
- [ ] #8 Schemas registered with agent server on startup
- [ ] #9 Resource URIs defined: `qualcoder://coding/tools/{tool_name}`

### Controller Integration
- [ ] #10 Each agent tool invokes corresponding Controller command
- [ ] #11 Controller returns Result[Event, Failure] â†’ tool returns success/error
- [ ] #12 Agent actions emit same domain events as UI actions (unified event stream)

<!-- AC:END -->

## Implementation Notes

**For MCP (Model Context Protocol):**
- Schemas follow MCP Tool Schema specification
- Registered via MCP server's tool registration API
- URIs use MCP resource format
