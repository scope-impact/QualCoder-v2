---
id: QC-013.03
title: Case Import/Export Adapters
status: To Do
assignee: []
created_date: '2026-01-29 16:41'
labels:
  - infrastructure
  - cases
  - P1
dependencies: []
parent_task_id: QC-013
---

## Description

<!-- SECTION:DESCRIPTION:BEGIN -->
CSV/XLSX import adapter: parse headers, map columns. Excel export adapter: generate XLSX with formatting. Handle various encodings.
<!-- SECTION:DESCRIPTION:END -->

## Acceptance Criteria
<!-- AC:BEGIN -->
### CaseImportAdapter Interface
- [ ] #1 `parse_headers(path: Path) -> List[str]` - extract column names
- [ ] #2 `preview_rows(path: Path, limit: int = 10) -> List[Dict[str, str]]`
- [ ] #3 `import_cases(path: Path, mapping: ColumnMapping) -> Result[ImportResult, ImportError]`

### Format Support
- [ ] #4 `CSVCaseImporter`: handles CSV with delimiter detection
- [ ] #5 `XLSXCaseImporter`: handles Excel files, reads first sheet
- [ ] #6 Factory: `CaseImporterFactory.for_file(path) -> CaseImporter`

### ColumnMapping Value Object
- [ ] #7 `ColumnMapping`: name_column (int), attribute_columns (Dict[int, AttributeTypeId])
- [ ] #8 Supports auto-create of AttributeTypes from unmapped columns

### CaseExportAdapter Interface
- [ ] #9 `export_to_xlsx(cases: List[Case], attributes: List[AttributeType], path: Path) -> Result[Path, ExportError]`
- [ ] #10 Generates formatted XLSX with headers, column widths, data types

### Export Formatting
- [ ] #11 First row: column headers (Case Name, then attribute names)
- [ ] #12 Numeric columns formatted as numbers
- [ ] #13 Date columns formatted with date format
- [ ] #14 Auto-width columns based on content

### Error Handling
- [ ] #15 `ImportError` union: FileNotFound, InvalidFormat, DuplicateCaseName, EncodingError
- [ ] #16 `ExportError` union: FileNotWritable, DiskFull, ExportFailed
- [ ] #17 Returns Result[T, Error] - explicit error handling
<!-- AC:END -->
