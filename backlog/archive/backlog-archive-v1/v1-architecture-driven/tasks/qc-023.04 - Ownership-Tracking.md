---
id: QC-023.04
title: Ownership Tracking
status: To Do
assignee: []
created_date: '2026-01-29 16:44'
labels:
  - infrastructure
  - collaboration
  - P0
dependencies: []
parent_task_id: QC-023
---

## Description

<!-- SECTION:DESCRIPTION:BEGIN -->
Add coder_id to segment storage. Track who coded each segment. Support ownership transfer on promote/merge.
<!-- SECTION:DESCRIPTION:END -->

## Acceptance Criteria
<!-- AC:BEGIN -->
### Schema Changes
- [ ] #1 Add `coder_id` column to segment tables (code_text, code_image, code_av)
- [ ] #2 Foreign key to coder table
- [ ] #3 Migration for existing data (default to first human coder)

### Repository Methods
- [ ] #4 `get_segment_owner(segment_id) -> CoderId`
- [ ] #5 `set_segment_owner(segment_id, coder_id) -> Result[None, Error]`
- [ ] #6 `transfer_ownership(segment_ids, from_coder, to_coder) -> int`
- [ ] #7 `find_segments_by_owner(coder_id) -> List[Segment]`

### Ownership Transfer (for Promotion/Merge)
- [ ] #8 `promote_ai_codings(segment_ids, human_coder_id) -> Result[int, Error]`
- [ ] #9 Batch transfer for efficiency
- [ ] #10 Emits CodingOwnershipChanged events

### Query Support
- [ ] #11 Segments include owner in query results
- [ ] #12 Filter segments by owner in repository queries
- [ ] #13 Index on coder_id for fast owner queries

### AI Coder Auto-Creation
- [ ] #14 Create AI coder on first agent coding if not exists
- [ ] #15 AI coder has special CoderType.AI
<!-- AC:END -->
