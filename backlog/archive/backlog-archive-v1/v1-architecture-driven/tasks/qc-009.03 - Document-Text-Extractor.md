---
id: QC-009.03
title: Document Text Extractor
status: To Do
assignee: []
created_date: '2026-01-29 16:40'
labels:
  - infrastructure
  - sources
  - P1
dependencies: []
parent_task_id: QC-009
---

## Description

<!-- SECTION:DESCRIPTION:BEGIN -->
Text extraction adapters: PDF (with page info), DOCX, ODT, RTF, EPUB, HTML. Return extracted text with position mapping for coding.
<!-- SECTION:DESCRIPTION:END -->

## Acceptance Criteria
<!-- AC:BEGIN -->
### TextExtractor Protocol (Interface)
- [ ] #1 `TextExtractor` protocol: `extract(path: Path) -> Result[ExtractedText, ExtractionError]`
- [ ] #2 Each format has dedicated implementation: PDFExtractor, DocxExtractor, etc.

### ExtractedText Value Object (frozen dataclass)
- [ ] #3 `ExtractedText`: text (str), page_breaks (List[int]), metadata (Dict)
- [ ] #4 `page_breaks` stores character positions where pages change (for PDF)
- [ ] #5 `metadata`: title, author, page_count, word_count

### Format-Specific Extractors
- [ ] #6 `PDFExtractor`: uses pdfminer or PyMuPDF, tracks page boundaries
- [ ] #7 `DocxExtractor`: uses python-docx, preserves paragraph breaks
- [ ] #8 `OdtExtractor`: uses odfpy, handles OpenDocument format
- [ ] #9 `HtmlExtractor`: uses BeautifulSoup, strips tags preserving structure
- [ ] #10 `EpubExtractor`: extracts text from EPUB chapters in order

### Error Handling
- [ ] #11 `ExtractionError` union: UnsupportedFormat, CorruptFile, PasswordProtected, ExtractionFailed
- [ ] #12 Returns Result[ExtractedText, ExtractionError] - no exceptions

### Factory Pattern
- [ ] #13 `TextExtractorFactory.for_file(path: Path) -> Optional[TextExtractor]`
- [ ] #14 Factory selects extractor based on file extension
- [ ] #15 Returns None for unsupported formats
<!-- AC:END -->
