---
id: QC-013.02
title: Attribute Repository
status: To Do
assignee: []
created_date: '2026-01-29 16:41'
labels:
  - infrastructure
  - cases
  - P0
dependencies: []
parent_task_id: QC-013
---

## Description

<!-- SECTION:DESCRIPTION:BEGIN -->
AttributeTypeRepository: CRUD for attribute types. AttributeValueRepository: store/retrieve attribute values with type validation.
<!-- SECTION:DESCRIPTION:END -->

## Acceptance Criteria
<!-- AC:BEGIN -->
### AttributeTypeRepository Methods
- [ ] #1 `save(attribute_type: AttributeType) -> AttributeTypeId`
- [ ] #2 `find_by_id(attribute_type_id) -> Optional[AttributeType]`
- [ ] #3 `find_all() -> List[AttributeType]`
- [ ] #4 `find_by_name(name: str) -> Optional[AttributeType]`
- [ ] #5 `delete(attribute_type_id) -> bool`
- [ ] #6 `update_type(attribute_type_id, new_value_type: ValueType) -> bool`

### AttributeValueRepository Methods
- [ ] #7 `set_value(case_id, attribute_type_id, value: str) -> None`
- [ ] #8 `get_value(case_id, attribute_type_id) -> Optional[str]`
- [ ] #9 `get_all_values_for_case(case_id) -> Dict[AttributeTypeId, str]`
- [ ] #10 `get_all_values_for_type(attribute_type_id) -> Dict[CaseId, str]`
- [ ] #11 `clear_value(case_id, attribute_type_id) -> bool`
- [ ] #12 `bulk_set_values(case_id, values: Dict[AttributeTypeId, str]) -> None`

### Type Validation
- [ ] #13 Validate value against AttributeType.value_type before storing
- [ ] #14 Return `Result[None, ValidationError]` on type mismatch
- [ ] #15 Support NULL/empty values for all types

### Cascade Operations
- [ ] #16 `delete_type_cascade(attribute_type_id)` - removes all values for type
- [ ] #17 `delete_case_cascade(case_id)` - removes all values for case

### Immutability
- [ ] #18 Returns frozen AttributeType entities
- [ ] #19 Values stored as strings, converted on read based on type
<!-- AC:END -->
