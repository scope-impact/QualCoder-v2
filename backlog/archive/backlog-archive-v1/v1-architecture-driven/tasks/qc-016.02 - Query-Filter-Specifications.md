---
id: QC-016.02
title: Query Filter Specifications
status: To Do
assignee: []
created_date: '2026-01-29 16:42'
labels:
  - domain
  - analysis
  - P0
dependencies: []
parent_task_id: QC-016
---

## Description

<!-- SECTION:DESCRIPTION:BEGIN -->
FilterSpec value objects: FileFilter, CaseFilter, CoderFilter, AttributeFilter, DateRangeFilter. Composable filter expressions.
<!-- SECTION:DESCRIPTION:END -->

## Acceptance Criteria
<!-- AC:BEGIN -->
### Filter Value Objects (frozen dataclasses)
- [ ] #1 `FileFilter`: source_ids (Optional[List]), source_types (Optional[List[SourceType]])
- [ ] #2 `CaseFilter`: case_ids (Optional[List]), attribute_filters (Optional[List])
- [ ] #3 `CoderFilter`: coder_ids (Optional[List]), include_ai (bool)
- [ ] #4 `DateRangeFilter`: start_date (Optional[date]), end_date (Optional[date])
- [ ] #5 `AttributeFilter`: attribute_type_id, operator (eq|ne|gt|lt|contains), value

### CompositeFilter (frozen dataclass)
- [ ] #6 `CompositeFilter`: file_filter, case_filter, coder_filter, date_filter, code_ids
- [ ] #7 All fields Optional - None means "no filter" (include all)
- [ ] #8 Immutable - modifications return new filter instance

### Pure Functions
- [ ] #9 `apply_filter(segments: List[Segment], filter: CompositeFilter) -> List[Segment]`
- [ ] #10 `combine_filters(f1, f2) -> CompositeFilter` - merges two filters (AND logic)
- [ ] #11 `is_segment_match(segment, filter) -> bool` - pure predicate

### Invariants
- [ ] #12 `is_valid_date_range(start, end) -> bool` - start <= end
- [ ] #13 `is_filter_empty(filter) -> bool` - all fields None
<!-- AC:END -->
