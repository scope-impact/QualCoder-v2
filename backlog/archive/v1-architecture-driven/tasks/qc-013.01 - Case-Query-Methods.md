---
id: QC-013.01
title: Case Query Methods
status: To Do
assignee: []
created_date: '2026-01-29 16:41'
labels:
  - infrastructure
  - cases
  - P0
dependencies: []
parent_task_id: QC-013
---

## Description

<!-- SECTION:DESCRIPTION:BEGIN -->
Repository query methods: find_all with filtering/sorting, find_by_attribute_value, get_case_statistics, find_members_by_case, count_by_attribute.
<!-- SECTION:DESCRIPTION:END -->

## Acceptance Criteria
<!-- AC:BEGIN -->
### CaseRepository Query Methods
- [ ] #1 `find_all(filter: CaseFilter, sort: SortSpec) -> List[Case]`
- [ ] #2 `find_by_attribute_value(attribute_type_id, value) -> List[Case]`
- [ ] #3 `find_members_by_case(case_id) -> List[CaseMembership]`
- [ ] #4 `count_by_attribute(attribute_type_id) -> Dict[str, int]` - value â†’ count

### Query DTOs (Read-only)
- [ ] #5 `CaseFilter`: name_pattern, attribute_filters (List[AttributeFilter]), has_members (bool)
- [ ] #6 `AttributeFilter`: attribute_type_id, operator (eq|ne|gt|lt|contains), value
- [ ] #7 `CaseWithMembers` DTO: case_id, name, memo, member_count, attribute_values

### Statistics Query
- [ ] #8 `get_case_statistics() -> CaseStatistics`
- [ ] #9 `CaseStatistics` DTO: total_count, with_members_count, attribute_type_count, avg_members_per_case

### Membership Queries
- [ ] #10 `find_cases_by_source(source_id) -> List[Case]` - cases containing source
- [ ] #11 `find_partial_memberships(case_id) -> List[CaseMembership]` - partial links only

### Immutability
- [ ] #12 All returned entities are frozen dataclasses
- [ ] #13 Query methods are read-only, never modify state
<!-- AC:END -->
