---
id: QC-020.01
title: Suggestion Queue Service
status: To Do
assignee: []
created_date: '2026-01-29 16:43'
labels:
  - application
  - ai-assistant
  - P0
dependencies: []
parent_task_id: QC-020
---

## Description

<!-- SECTION:DESCRIPTION:BEGIN -->
SuggestionQueueService: queue pending suggestions, priority ordering, batch approve/reject operations, queue capacity limits, FIFO/priority modes.
<!-- SECTION:DESCRIPTION:END -->

## Acceptance Criteria
<!-- AC:BEGIN -->
### Suggestion Value Object (frozen dataclass)
- [ ] #1 `Suggestion`: suggestion_id, tool_name, input_params, trust_level, created_at, priority
- [ ] #2 `SuggestionStatus` enum: PENDING, APPROVED, REJECTED, EXPIRED
- [ ] #3 Immutable - status changes create new Suggestion with updated status

### SuggestionQueueService Interface
- [ ] #4 `enqueue(suggestion: Suggestion) -> Result[SuggestionId, QueueError]`
- [ ] #5 `approve(suggestion_id) -> Result[SuggestionApproved, ApproveError]`
- [ ] #6 `reject(suggestion_id) -> Result[SuggestionRejected, RejectError]`
- [ ] #7 `batch_approve(suggestion_ids: List) -> Result[BatchApproved, Error]`
- [ ] #8 `batch_reject(suggestion_ids: List) -> Result[BatchRejected, Error]`
- [ ] #9 `get_pending() -> List[Suggestion]` - ordered by priority/time

### Queue Configuration
- [ ] #10 `QueueMode` enum: FIFO (first-in-first-out), PRIORITY (by trust level/importance)
- [ ] #11 `max_pending_limit: int` - rejects new suggestions when at capacity
- [ ] #12 `expiry_duration: timedelta` - auto-expire old suggestions

### Event Publishing
- [ ] #13 `SuggestionReceived` event: suggestion_id, tool_name, trust_level
- [ ] #14 `SuggestionApproved` event: suggestion_id, approved_by
- [ ] #15 `SuggestionRejected` event: suggestion_id, rejected_by, reason

### Thread Safety
- [ ] #16 Queue operations are thread-safe (agent runs in separate thread)
- [ ] #17 Use locks or thread-safe collections for concurrent access
<!-- AC:END -->
